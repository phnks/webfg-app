AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: 'Main GraphQL API template'

Parameters:
  Environment:
    Type: String
    Description: 'Deployment environment (prod/qa)'
    AllowedValues:
      - 'prod'
      - 'qa'
  ServiceName:
    Type: String
    Description: 'Name of the service'
  AppSyncApiName:
    Type: String
    Description: 'Name for the AppSync API'
  CharactersDataSourceName:
    Type: String
    Description: 'Name of db data source'
  ObjectsDataSourceName:
    Type: String
    Description: 'Name of db data source'
  ActionsDataSourceName:
    Type: String
    Description: 'Name of db data source'
  EncountersDataSourceName:
    Type: String
    Description: 'Name of db data source'
  SkillsDataSourceName: # Re-add parameter
    Type: String
    Description: 'Name of Skills db data source'
    Default: 'SkillsDataSource' # Add default consistent with template.yaml
  AttributesDataSourceName: # Re-add parameter
    Type: String
    Description: 'Name of Attributes db data source'
    Default: 'AttributesDataSource' # Add default consistent with template.yaml
  CharactersTableName:
    Type: String
    Description: 'Name of table'
  ObjectsTableName:
    Type: String
    Description: 'Name of table'
  ActionsTableName:
    Type: String
    Description: 'Name of table'
  SkillsTableName: # Re-add parameter
    Type: String
    Description: 'Name of Skills table'
  AttributesTableName: # Re-add parameter
    Type: String
    Description: 'Name of Attributes table'
  FormulasDataSourceName:
    Type: String
    Description: 'Name of Formulas db data source'
    Default: 'FormulasDataSource'
  FormulasTableName:
    Type: String
    Description: 'Name of Formulas table'
  PhnksCertArn:
    Type: String
    Description: 'ARN of the certificate for the custom domain'
  PhnksHostedZoneId:
    Type: String
    Description: 'Hosted Zone ID for the custom domain'
  DomainName:
    Type: String
    Description: 'Domain name of the service'
  SchemaS3Key:
    Type: String
    Description: S3 key for the GraphQL schema file
  SchemaS3BucketName:
    Type: String
    Description: "Name of the S3 bucket containing the GraphQL schema"
  EncountersTableName:
    Type: String
    Description: 'Name of encounters table'

Globals:
  Function:
    Timeout: 30
    MemorySize: 1024
    Runtime: nodejs20.x # Or your preferred runtime

Resources:
  ApiStack:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: ./api.yaml
